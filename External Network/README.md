# ✅ Passive/OSINT

Look at all the things before engaging in any way with the target(s)

> Use multiple search engines

## 🥸 Google Dorking

```bash
intext:"@domain.com"
```

## 📧 Email Address Enumeration

```
# Google dorking
"@domain.com"

# TheHarvester
theHarvester -d microsoft.com -l 500 -b google -f myresults.html

# Use crosslinked after figuring out the naming convention
/opt/crosslinked/crosslinked.py -f {first}@<DOMAIN> <COMPANY NAME>
```

## 🪪 Check for leaked credentials with Dehashed

##### Get the breached credentials

```bash
curl 'https://api.dehashed.com/search?query=%40<DOMAIN>' -u $USERNAME$:$DEHASHED_KEY  -H 'Accept: application/json' > dehashed.json
```

##### Print out the plaintext passwords

```
cat dehashed.json | jq .'entries[] | "\(.email):\(.password)"'
```

## 🖥️ Hostname enumeration

Run this script on lab2

```
/opt/hunter.sh scope.txt
```

## 🏗️ Check censys/shodan/certificate transparnecy for infrastructure enumeration

```bash
# Use shodan on the command line
for i in $(cat hosts.txt);do shodan host $i;done
```

[Censys Search](https://search.censys.io)

## ✅ Search for exposed AWS buckets

[Grayhatwarfare](https://grayhatwarfare.com)

# ✅ Active Enumeration

See also footprinting (LINK TO BE ADDED)

## 🔎 Nmap scans


It’s best to do a limited scan or perform a ping scan to determine which hosts are actually alive. This will save **significant** time later on. 

### Discovery Scan

```
sudo nmap -iL scope.txt -sn -PS21,22,23,25,80,110,135,137,139,389,443,445,636,990,992,1433,2049,3306,5060,8080,8090,8088,8888,9090,10000 -PU53,69,88,123,161,500,514,623,5060 -PE
```

### Full TCP Scan

```
sudo nmap -iL alive-hosts.txt -Pn -p- -O --max-rtt-timeout 1000ms --max-retries 2 -oA nmap_tcp -vv --open -A
```

### UDP Scan

```
sudo nmap -iL alive-hosts.txt -Pn -n -sU -p 53,67-69,111,123,135,137-139,161-162,445,500,514,520,623,631,996-999,1434,1701,1900,3283,4500,5353,49152-49154 -O --max-rtt-timeout 600ms --max-retries 2 -oA nmap_udp -vv --open -A
```

## 🍒 Low hanging fruit

### CBC Ciphers and TLS Versions

```
sudo nmap -Pn -iL ranges --script +ssl-enum-ciphers -p443
```

### Check HSTS

```
sudo nmap -Pn -iL ranges --script +http-security-headers -p 443
```

### Check for self-signed certs

```
sudo nmap -Pn -iL ranges --script +ssl-cert -p $PORTS --open
```

### Check SSH algorithms

```
sudo nmap -Pn -iL ranges --script +ssh2-enum-algos -p22
```

### Check IIS Shortnames

```
sudo nmap -Pn -iL ranges --script +http-iis-short-name-brute -p443
```

### Check RDP Encryption

```
sudo nmap -Pn -iL ranges --script +rdp-enum-encryption -p3389
```

### Check for weak DH exchange

```
sudo nmap -Pn -iL ranges --script +ssl-dh-params -p443
```

### Check for Big-IP internal IP address disclosure

```
sudo nmap -Pn -iL ranges --script +http-bigip-cookie -p443
```

### Check HTTP Headers

```
sudo nmap -Pn -iL ranges --script +http-headers -p443
```

### Check for SMB Signing

```
sudo nmap -Pn -iL ranges --script +smb-protocols,smb2-security-mode,smb-security-mode -p445
```

## 🕸️ Web crawling

> I usually do directory busting on each host, instead of trying to use something like interlace.

```
gospider -s https://example.com -c 10 -d 1 -o output
```

## ⚛️ Nuclei

> Get this list from hexecution

```
nuclei -l nuclei-scope.txt -je nuclei-out.json
```

## 🔐 TLS Scans

> Use the same listing as for nuclei. 

```
sslscan --targets=sslscan-scope
```

## 🖼️ Framing

```html
<html>
<head>
    <title>This site is embedded in an iframe</title>
</head>
<body>
    <p style="background-color: yellow"><strong>This site is being framed.</strong></p>
    <iframe src="https://demo.smarterdx.app/" width="1000" height="1000"></iframe>
</body> 
</html>```


